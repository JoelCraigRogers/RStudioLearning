---
title: "Module 5"
output: html_notebook
---
#Module 5 Data Visualization Principles
This module we will review general principles for effective data visualization. 
##Introduction
Humans detect patterns and use those patterns to make decisions.  It is important that we display the data in a way that fits with how the people who read it understand.  
Match the presentation to the audience.  
  A general audience may need a different or less complex display than experts familiar with viewing complex presentations. 
##Chapter 10:  Data Visualization
Much of the code we based these on is available from the GitHub repository.
Will add the link at the botton. 
##Encoding Data Using Visual cues
Principles for Data Visualization:
  Position
  Aligned Length
  Angles
  Area
  Brightness
  Color Hue

Pie Charts - Popular way to display data in percentages. 
  May not be the best way to display the data.
  Represents Areas and Angles to display the data
  Showing the numbers may be a less confusing way.
  Barplot may be the best option to display the data.  
  If you must make a pie chart add the % to the output
  
##Know When to Include Zero
If you do not show the graph from 0 it can misrepresent the data.  
  It will make small changes appear larger since it only shows the change, not the whole.
  Often used by politicians to sway the opinion of the public.  
  If you use Length to represent data it is critical to start from 0 so that the data is accurately presented.  
  
When using position (not length) it may not be needed to include the 0.
  Can eliminate blocks that have no data and allow you to increase the size of the area with data. 

##Do not distort quantities
Also commonly used by politicians when they display data.  
Using shapes to present the data can distort the actual data. 
ggplot defaults to use area which creates less distortion.  
  using radius will cause the area to inaccurately scale. 
Often using images that change in size is not the most accurate way to compare. 
  Position and length are usually better to represent data
  
##Order by a meaningful value
Displaying ordered by alphabetical order may not be the most meaningful.  
The reorder function can help us meaningful presentation.  
```{r}
library(tidyverse)
library(dslabs)
data("murders")

murders %>% mutate(murder_rate = total/population*1000000) %>%
  #mutate(state = reorder(state , murder_rate)) %>%
  ggplot(aes(x = state, y = murder_rate)) +
  geom_bar(stat = "identity") +
  coord_flip() +
  theme(axis.text.y = element_text(size = 6)) +
  xlab("")
# Compare to
murders %>% mutate(murder_rate = total / population*1000000) %>%
  mutate(state = reorder(state , murder_rate)) %>%
  ggplot(aes(x = state, y = murder_rate)) +
  geom_bar(stat = "identity") +
  coord_flip() +
  theme(axis.text.y = element_text(size = 6)) +
  xlab("")
  

```
##5.2 Data Visualization Principles: Part 2
## Show the Data
Common way to compare groups is the standard error and the average. 
This can misrepresent the dataset:
  Does not show the distribution
  With the heights dataset it goes from 0.  This could impply there are 0inch tall people
```{r}
library(dslabs)
library(tidyverse)
library(dplyr)
data(heights)

heights %>% 
  ggplot(aes(sex,height )) +
  geom_point()
```
This point plot shows the distribution of the heights, without implying there are additional data where no points actually lay, such as 0.
For a large dataset this may not always be clear. 
  jitter and alpha blending can help display this data
  geom_jitter (geometry) widens out the points.  This allows more points to be visible without placing points on top of each other. 
    alpha blending darkens the area with the highest density of points.  Lighter areas are less dense.  
  
```{r}
heights %>% ggplot(aes(x = sex , y = height)) +
  geom_jitter(width = .1 , alpha = .2)

heights %>% ggplot(aes(sex , height)) +
  geom_jitter(width = .1)
```
##Use common axis
Align plots vertically to show horizontal changes
Align graphs horizontally to show vertical changes. 
```{r}
heights %>% ggplot(aes(height , ..density..)) +
  geom_histogram(binwidth = 1 , color = "black") +
  facet_grid(sex~.)
##
heights %>% 
  ggplot(aes(sex, height)) +
  geom_boxplot(coef= 3) +
  geom_jitter(width = .1, alpha = .2) +
  ylab("Height(inches)")

```
##Consider Transformations
Log transformations may make data more representative.
##Compared visual cues should be adjacent. 
Alphabetically may not always be the best way to compare the data. 
##Slope charts
Scatterplots are generally good to compare two data points. 
Slope charts may be useful when there are a small number of points. 
  Slope charts get cluttered if there are many points. 
Bland Altman plot - Shows the difference vs the average
```{r}
library(tidyverse)
library(dslabs)
data("gapminder")
#Create regions
west <- c("Western Europe" , "Northern Europe" , "Southern Europe" , "North America" ,
          "Australia and New Zealand")
dat <- gapminder %>%
  filter(year %in% c(2010, 2015) & region %in% west & !is.na(life_expectancy) & population > 10^7)

dat %>%
  mutate(location = ifelse(year ==2010, 1 , 2),
         location = ifelse(year == 2015 & country %in% c("United Kingdom" , "Portugal"),
                           location + .22 , location) ,
         hjust = ifelse(year == 2010 , 1 , 0)) %>%
  mutate(year = as.factor(year)) %>%
  ggplot(aes(year , life_expectancy , group = country)) +
  geom_line(aes(color = country) , show.legend = FALSE) +
  geom_text(aes(x = location , label = country , hjust = hjust), show.legend = FALSE) +
  xlab("") +
  ylab("Life Expectancy")
  
         

```
##Encoding a third variable
RColorBrewer can bring in more color display options
These diverging color options can present the different magnitudes of a value. 

```{r}
library(RColorBrewer)
display.brewer.all(type="seq")
display.brewer.all(type = "div")
```

